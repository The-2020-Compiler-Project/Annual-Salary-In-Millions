<h1 align="center">第二次过程报告</h1>

<p align="right">--计算机1802刘文兴-20184402</p>

这周开始，我们重新讨论了一下接下来的分工，我的任务是辅助钟洁同学使用DAG图完成四元式的优化，因此我去复习了一下相关内容，查阅了网络上的一些[代码实现](https://github.com/LibertyinDeath/dag-compiler_theory/blob/master/main.cpp)。

不过在实际开发过程中，钟洁同学完成了大部分工作，我主要是对其代码进行了校对，修正了部分错误，修改了包含关系，以及尝试对接语义分析等等。

-------

在完成以上工作后，我去阅读了一下项目源码，发现在项目开发过程中，出现了很多将公有变量定义写在`.cpp`文件中的情况，例如在四元式优化的`DAG`文件中，需要访问语义分析中生成的四元式和符号表，但四元式和符号表都是`grammatical_analysis.cpp`文件内定义的变量。

这导致了很多在`.h`文件里包含`.cpp`，`.cpp`文件里包含`.cpp`的情况，使依赖关系变得极其复杂；同时，这样的代码会导致很多的重定义问题，在某些编译器上无法编译通过（比如我的`linux`下的`gcc`）。

因此，我调整了文件间的依赖关系，尽可能地理清了文件之间的联系。

-------

在这之后，我进行了`GUI`的编写（使用`qt`进行开发），并将其与后端的语法分析、语义分析、目标代码生成的函数进行了对接，窗口展示如下：

![image-20200709132646132](https://allwens-work.oss-cn-beijing.aliyuncs.com/bed/image-20200709132646132.png)

打开文件后，上面的文本框内显示路径信息，下面的文本框显示文件内容。

点击生成四元式后，对当前打开的文件进行处理，报错信息以对话框的形式进行提示。

如果未出现错误，则文本框内显示优化后的四元式。

接着点击生成目标代码，会调用目标代码生成函数对优化后的四元式进行处理，最终将目标代码显示到文本框中。